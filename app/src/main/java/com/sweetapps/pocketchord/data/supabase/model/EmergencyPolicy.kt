package com.sweetapps.pocketchord.data.supabase.model

import kotlinx.serialization.SerialName
import kotlinx.serialization.Serializable

/**
 * ê¸´ê¸‰ ìƒí™© ì •ì±… ëª¨ë¸
 *
 * Supabase í…Œì´ë¸” êµ¬ì¡° (emergency_policy):
 * ```sql
 * CREATE TABLE public.emergency_policy (
 *     id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
 *     created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
 *     app_id TEXT NOT NULL,
 *     is_active BOOLEAN NOT NULL DEFAULT TRUE,
 *     content TEXT NOT NULL,
 *     redirect_url TEXT,
 *     button_text TEXT,
 *     is_dismissible BOOLEAN NOT NULL DEFAULT TRUE,
 *     CONSTRAINT emergency_policy_pkey PRIMARY KEY (id)
 * )
 * ```
 *
 * ì‚¬ìš© ëª©ì :
 * - ì•±ì´ í”Œë ˆì´ìŠ¤í† ì–´ì—ì„œ ì°¨ë‹¨ëœ ê²½ìš°
 * - ì„œë¹„ìŠ¤ ì¢…ë£Œ ì•ˆë‚´
 * - ê°•ì œ ë§ˆì´ê·¸ë ˆì´ì…˜ (ìƒˆ ì•±ìœ¼ë¡œ ì´ë™)
 *
 * í•µì‹¬ ê¸°ëŠ¥:
 * - is_dismissible: X ë²„íŠ¼ ì œì–´ (Google Play ì •ì±… ì¤€ìˆ˜)
 * - ì¶”ì  ì—†ìŒ: ë§¤ë²ˆ í‘œì‹œ (ì‚¬ìš©ìê°€ ì¡°ì¹˜ ì·¨í•  ë•Œê¹Œì§€)
 * - ìµœìš°ì„ ìˆœìœ„: ë‹¤ë¥¸ ëª¨ë“  íŒì—…ë³´ë‹¤ ìš°ì„ 
 *
 * ì‚¬ìš© ì˜ˆì‹œ:
 * ```kotlin
 * val emergency = emergencyPolicyRepository.getActiveEmergency()
 *
 * emergency?.let {
 *     EmergencyRedirectDialog(
 *         description = it.content,
 *         redirectUrl = it.redirectUrl,
 *         isDismissible = it.isDismissible,  // â† DBì—ì„œ ì œì–´!
 *         onDismiss = if (it.isDismissible) { ... } else null
 *     )
 * }
 * ```
 */
@Serializable
data class EmergencyPolicy(
    /**
     * ì •ì±… ID (ìë™ ìƒì„±)
     */
    @SerialName("id")
    val id: Long? = null,

    /**
     * ìƒì„± ì‹œê°„ (ISO 8601 í˜•ì‹)
     * ì˜ˆ: "2025-11-09T10:30:00Z"
     */
    @SerialName("created_at")
    val createdAt: String? = null,

    /**
     * ì•± ID (íŒ¨í‚¤ì§€ëª…)
     * ì˜ˆ: "com.sweetapps.pocketchord"
     */
    @SerialName("app_id")
    val appId: String,

    /**
     * í™œì„±í™” ì—¬ë¶€
     * - true: ê¸´ê¸‰ ìƒí™© í™œì„±í™” (íŒì—… í‘œì‹œ)
     * - false: ê¸´ê¸‰ ìƒí™© í•´ì œ (íŒì—… í‘œì‹œ ì•ˆ í•¨)
     */
    @SerialName("is_active")
    val isActive: Boolean = false,

    /**
     * ê¸´ê¸‰ ë©”ì‹œì§€
     *
     * ì˜ˆì‹œ:
     * - "âš ï¸ ì´ ì•±ì€ ë” ì´ìƒ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nìƒˆ ë²„ì „ì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”."
     * - "ğŸš¨ ì„œë¹„ìŠ¤ ì¢…ë£Œ ì•ˆë‚´\n2025ë…„ 12ì›” 31ì¼ë¶€ë¡œ ì„œë¹„ìŠ¤ê°€ ì¢…ë£Œë©ë‹ˆë‹¤."
     */
    @SerialName("content")
    val content: String,

    /**
     * ë¦¬ë‹¤ì´ë ‰íŠ¸ URL
     *
     * ì‚¬ìš©ìê°€ ë²„íŠ¼ í´ë¦­ ì‹œ ì´ë™í•  URL
     * ì˜ˆ: "https://play.google.com/store/apps/details?id=com.sweetapps.newapp"
     */
    @SerialName("redirect_url")
    val redirectUrl: String? = null,

    /**
     * ë²„íŠ¼ í…ìŠ¤íŠ¸
     *
     * "í™•ì¸" ë²„íŠ¼ì˜ í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •
     * ì˜ˆ: "í™•ì¸", "ìƒˆ ì•± ì„¤ì¹˜í•˜ê¸°", "ìì„¸íˆ ë³´ê¸°"
     * ê¸°ë³¸ê°’: "í™•ì¸"
     */
    @SerialName("button_text")
    val buttonText: String = "í™•ì¸",

    // ===== Google Play ì •ì±… ì¤€ìˆ˜ (í•µì‹¬!) =====

    /**
     * X ë²„íŠ¼ í—ˆìš© ì—¬ë¶€
     *
     * Google Play ì •ì±…:
     * "ì‚¬ìš©ìê°€ ì›í•˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€í™”ìƒìë‚˜ ì „ì²´ í™”ë©´ ë©”ì‹œì§€ë¥¼ ë‹«ì„ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤."
     *
     * ê¶Œì¥ ì‚¬ìš©:
     * - true (ê¸°ë³¸ê°’): X ë²„íŠ¼ í‘œì‹œ (Google Play ì •ì±… ì¤€ìˆ˜) âœ…
     * - false: X ë²„íŠ¼ ìˆ¨ê¹€ (ìµœí›„ì˜ ìˆ˜ë‹¨, ì •ì±… ìœ„ë°˜ ê°€ëŠ¥ì„±) âš ï¸
     *
     * ì˜ˆì‹œ:
     * - ì„œë¹„ìŠ¤ ì¢…ë£Œ ì˜ˆì • (ì„ íƒ ê°€ëŠ¥): true
     * - ì•± ì™„ì „ ì°¨ë‹¨ (ê°•ì œ): false (ì£¼ì˜!)
     */
    @SerialName("is_dismissible")
    val isDismissible: Boolean = true
)

