# AdMob Supabase 제어 구현 결정사항

> **작성일**: 2025-01-08  
> **목적**: 구현 전 최종 의사결정

---

## ✅ 결정이 필요한 항목

### 1. 구현 범위 선택

**질문**: 어떤 범위로 구현할까요?

- [ ] **Option A: 기본 구현** (빠르게, 1-2일)
  - 광고 ON/OFF 제어만
  - 빈도 제한은 나중에 추가
  
- [ ] **Option B: 완벽한 구현** (추천, 2-3일)
  - 광고 ON/OFF + 빈도 제한 모두 포함
  - 한 번에 완성

**내 결정**: 

```
(여기에 A 또는 B를 적어주세요)

option B, 

이유: 효율적임


```

---

### 2. Supabase 테이블 스키마

**질문**: Supabase app_policy 테이블에 어떤 컬럼을 추가할까요?

**필수 컬럼** (Option A, B 공통):
- [ ] `ad_app_open_enabled` (BOOLEAN) - 앱 오픈 광고 ON/OFF
- [ ] `ad_interstitial_enabled` (BOOLEAN) - 전면 광고 ON/OFF
- [ ] `ad_banner_enabled` (BOOLEAN) - 배너 광고 ON/OFF

**선택 컬럼** (Option B 선택 시):
- [ ] `ad_interstitial_max_per_hour` (INT) - 시간당 최대 횟수
- [ ] `ad_interstitial_max_per_day` (INT) - 하루 최대 횟수

**내 결정**:

```
필수 컬럼: 전체 추가한다 

선택 컬럼: 전체 추가한다 
```

---

### 3. 기본값 설정

**질문**: 정책 조회 실패 시 어떻게 할까요?

- [ ] **Option A: 광고 활성화** (true)
  - 네트워크 오류 시에도 광고 수익 보호
  - 보수적 접근 (수익 우선)
  
- [ ] **Option B: 광고 비활성화** (false)
  - 사용자 경험 우선
  - 오류 시 광고 표시 안 함

**내 결정**:

```
(여기에 A 또는 B를 적어주세요)
Option A

이유: 
- 네트워크 오류로 광고 수익 손실 방지
- 일시적 연결 문제는 자주 발생하므로 보수적 접근이 안전
- 다음 조회 시 정상 정책 반영됨


```

---

### 4. 구현 우선순위

**질문**: 어떤 광고부터 구현할까요?

**추천 순서**: Banner → Interstitial → App Open
- 이유: 간단한 것부터 → 복잡한 것 순서

**대안 순서**: App Open → Interstitial → Banner
- 이유: 가장 큰 영향력부터

**내 결정**:

```
구현 순서:

1. Banner
2. Interstitial
3. App Open

이유: 추천 순으로 작업할 것


```

---

### 5. 빈도 제한 초기값 (Option B 선택 시)

**질문**: Interstitial Ad 빈도 제한을 어떻게 설정할까요?

**보수적 설정** (추천):
- 시간당 최대: 2회
- 하루 최대: 15회
- 이유: 사용자 반응 보면서 조정

**표준 설정**:
- 시간당 최대: 3회
- 하루 최대: 20회
- 이유: Google 권장 수준

**적극적 설정**:
- 시간당 최대: 4회
- 하루 최대: 30회
- 이유: 수익 최대화

**내 결정**:

```
시간당 최대: 2회

하루 최대: 15회

이유: 보수적으로 시작하는게 낫다.
Google 권장 수준에서 더 넘어가지 못하게 리미트를 걸수 있으면 걸어줘

```

---

### 6. 기존 테스트 모드 코드

**질문**: SharedPreferences 기반의 기존 테스트 코드를 어떻게 할까요?

- [ ] **완전 삭제**
  - Supabase 제어로 완전히 대체
  - 코드 단순화
  
- [ ] **유지**
  - 개발 중 편의를 위해 남겨둠
  - 릴리즈 빌드에서는 비활성화

**내 결정**:

```
(여기에 선택사항을 적어주세요)
완전 삭제

이유: Supabase로 완전히 대체하는게 낫다.


```

---

### 7. 디버그 화면의 광고 스위치

**질문**: MainActivity의 디버그 설정 화면을 어떻게 할까요?

현재 상태:
- 배너 광고: ON/OFF 스위치 있음 (SharedPreferences)
- 전면 광고: 로그만 ON/OFF
- 앱 오픈: 테스트 모드 스위치

**Option A: 모두 제거**
- Supabase로만 제어
- 디버그 화면 단순화

**Option B: 유지하되 "로컬 오버라이드"로 변경**
- Supabase 정책 > 로컬 설정 우선순위
- 개발 중 테스트 편의성

**Option C: 읽기 전용으로 변경**
- 현재 Supabase 정책 상태만 표시
- 변경은 Supabase에서만

**내 결정**:

```
(여기에 A, B, 또는 C를 적어주세요)
Option A: 모두 제거

이유: supabase로 제어하는게 낫다


```

---

### 8. 정책 캐싱

**질문**: Supabase 정책을 캐싱할까요?

**캐싱 = "자주 쓰는 정보를 메모장에 적어두고 잠깐 동안 재사용하는 것"**

**🏫 학교 시간표로 비유:**
- 캐싱 안 함 = 매 시간마다 선생님한테 물어보기 (정확하지만 귀찮음)
- 5분 캐싱 = 아침에 물어보고 5분 동안 메모 사용 (빠르고 편함) ⭐
- 앱 재시작 = 아침에 한 번만 물어보고 하루종일 메모 사용 (빠르지만 바뀌어도 모름)

**Option A: 캐싱 안 함**
- 매번 Supabase에서 조회
- 항상 최신 정책 반영 (즉시!)
- 네트워크 호출 증가 (느릴 수 있음)
- **추천 대상**: 긴급 대응이 매우 중요한 경우

**Option B: 짧은 캐싱 (5분) ⭐ 추천**
- 5분마다 Supabase 조회
- 네트워크 부하 감소 (빠름!)
- 정책 변경 시 최대 5분 지연 (충분히 빠름)
- **추천 대상**: 대부분의 경우 (속도와 반응성 균형)

**Option C: 앱 재시작 시에만 갱신**
- 앱 시작 시 1번만 조회
- 네트워크 최소화 (매우 빠름)
- 정책 변경 시 앱 재시작 필요 (느림)
- **추천 대상**: 정책이 거의 안 바뀌는 경우

**💡 실제 시나리오:**

광고에 문제가 생겨서 긴급하게 OFF 해야 함!
- Option A: 즉시 반영 ✅
- Option B: 최대 5분 후 반영 ⚠️ (충분히 빠름!)
- Option C: 사용자가 앱 재시작해야 반영 ❌

**내 결정**:

```
(여기에 A, B, 또는 C를 적어주세요)
Option B

이유: 속도와 반응성의 균형이 좋다.


```

---

## 📝 최종 결정 요약

위 항목들을 모두 작성하신 후, 여기에 간단히 요약해주세요:

```
1. 구현 범위: option B

2. 추가할 컬럼: 필수 컬럼 전체, 선택 컬럼 전체

3. 기본값: Option A

4. 구현 순서: Banner → Interstitial → App Open

5. 빈도 제한 초기값: 시간당 최대: 2회, 하루 최대: 15회

6. 기존 테스트 코드: 완전 삭제

7. 디버그 화면: Option A: 모두 제거

8. 정책 캐싱: Option B

```

---

## 🚀 다음 단계

결정사항을 모두 작성하신 후:

1. 이 파일을 저장하고
2. 파일 내용을 저장해서 보여주시면
3. 바로 코드 구현을 시작하겠습니다!

---

## 💡 참고사항

- 결정하기 어려운 항목이 있으면 "잘 모르겠음" 이라고 적어주세요
- 추천 옵션은 ⭐로 표시되어 있습니다
- 나중에 변경 가능하니 부담 없이 결정하셔도 됩니다

